<head><title></title><meta charset="utf-8"><link rel="stylesheet" href="./styles.css"></head><body class="light-theme blue_sky" style="padding: 20px;"><div class="shine-editor"><h1>CHAPTER 10 환경 설정 자동화</h1><div><br></div><h2>10.1 네트워크 IP 설정하기</h2><h3>사전 분석</h3><ul><li>nmcli 명령어는 <code spellcheck="false">community.general.nmcli</code>&nbsp;모듈을 제공한다.</li><li>netplan은 파일이므로 사전에 netplan 파일 구조를 확인하고 jinja2 템플릿으로 작성한다.</li><li>운영체제가 레드햇이면서 앤서블 오토메이션 플랫폼을 사용할 경우에는 redhat.rhel_system_roles.network 라는 룰을 사용할 수 있다.</li><li>예제에서는 ethernet 타입의 네트워크 IP를 설정한다.</li><li>IP 설정 관련 정보는 메인 플레이북에서 변수로 정의한다.</li><li>변수로 정의한 네트워크 인터페이스가 실제 호스트에 존재하는지&nbsp;앤서블 팩트를 통해 확인한다.</li><li>운영체제가 CentOS이거나 레드햇일 경우에는 nmcli 모듈을 사용하여 IP를 설정한다. (OS 구분)</li><li>운영체제가 우분투일때 netplan 파일을 이용하여 IP를 설정한다.&nbsp;(OS 구분)</li></ul><div><br></div><div><img width="100%" src="Files/image.png"><br></div><div><br></div><h2>10.2 호스트명 설정하기</h2><h3>사전 분석</h3><ul><li>앤서블로 접근하기 위한 대상 서버들은 이미 제어 노드의 인벤토리에 등록되어 있다.</li><li>호스트명 설정을 하기 위해 ansible.builtin.hostsname 모듈을 사용한다.</li><li>/etc/hosts 에 tnode 정보들을 등록하기 위해 필요한 정보들을 변수로 정의한다.</li><li>호스트명을 hosts 파일에 추가할 때는 ansible.builtin.lineinfile 모듈을 사용한다.</li></ul><div><br></div><div><img width="100%" src="Files/image%202.png"><br></div><div><br></div><pre spellcheck="false">webserver.example.com<br>    |        |     |<br>    |        |     +-- 최상위 도메인(TLD)<br>    |        +-------- 도메인<br>    +----------------- 호스트명</pre><div><br></div><div><br></div><div><br></div><h2>10.3 NFS 서버 설치 및 NFS 스토리지 마운트하기</h2><h3>사전 분석</h3><ul><li>NFS 구성 방법 및 플레이북 모듈은 챗 GPT를 통해 찾은 플레이북을 참조한다.</li><li>실습 환경에서는 NFS 서버를 CentOS에 구성한다.</li><li>NFS 서버가 구성되면 나머지 두 노드에는 NFS 스토리지를 마운트한다.</li><li>플레이북 재사용을 위한 NFS 서버 및 클라이언트는 롤로 구성한다.</li></ul><div><br></div><div><img width="100%" src="Files/image%203.png"><br></div><div><img width="100%" src="Files/image%204.png"><br></div><div><br></div><div><br></div><div><br></div><h2>10.4 DB 애플리케이션 설치하기</h2><h3>사전 분석</h3><ul><li>테스트 환경에서 가장 많이 설치하는 데이터베이스인 MYSQL을 AWS CentOS에 설치한다.</li><li>앤서블 갤럭시에서 우분투에서 설치할 수 있는 MySQL 롤을 검색하여 해당 롤을 이용한다.</li><li>검색된 롤은 레드햇과 데비안 계열 운영채제에서 MySQL을 설치할 수 있다.</li></ul><div><br></div><h3>플레이북 설계</h3><ul><li>ansible.cfg</li><li>inventory<br><pre spellcheck="false">[db]<br>tnode-centos.exp.com</pre></li><li>install_mysql.yml<br><pre spellcheck="false">roles:<br> - role: geerlingguy.mysql</pre></li><li><div>Roles</div><pre spellcheck="false">자신이 사용하고 있는 컬렉션 명(geerlingguy.mysql)</pre><div><br></div></li></ul><div><br></div><div><br></div><div><br></div><div><br></div></div></body>